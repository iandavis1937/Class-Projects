---
output:
  pdf_document: default
header-includes:
  - \usepackage{color}
---
----
 Summer 2021: Introduction to Data Science
---

```{r, echo = F, results = 'hide', message=F, warning = F}
library(foreign)      #Default package for almost all code, lets your read files into R
library(ggplot2)      #plotting package
library(colorspace)   #better colors for ggplot
library(broom)        #a widely used, but relatively new, package for producing tidier data and tidier output; part of tidyverse
library(tidyverse)    #a widely used, but relatively new, package for producing tidier data and tidier output
library(stargazer)    #produces pretty regression tables
library(knitr)        #helps the knitting process. In particular, it lets the include_graphics command run
```

# Unit 4 Lab 1: Visualizing One Variable & Bivariate Categorical Visualizations

### Author:_____Ian Davis_____

\textcolor{red}{Total Points for Lab 1: 25} 

This lab is designed to introduce  you to ggplot and the choices involved in any data analysis project. This builds the first pieces for understanding and using Unit4_Lab1_Poster_DataSummariesVisuals.pdf. We will discuss

-  distributions of one variable and how to choose between histograms (corresponding to numeric summaries of means/medians/mins/maxes) and bar plots (corresponding to numeric summaries of counts/percentages) based on the format of your data and the story you want to present.
- bivariate categorical relationships and how to choose the appropriate visual based on the story you want to present

## Template for lab report
\textbf{Instructions:} This is the template you will use to type up your responses to the exercises. To produce a document that you can print out and turn in just click on Knit PDF above. All you need to do to complete the lab is to type up your BRIEF answers and the R code (when necessary) in the spaces provided below. If you want to find out more about the markdown language click on the MD icon.

It is strongly recommended that you knit your document regularly (minimally after answering each exercise) for two reasons. 

  1. Ensure that there are no errors in your code that would prevent the document from knitting.
  2. View the instructions and your answers in a more legible, attractive format.

### Some quick tips in case you forgot:

To create a new code chunk:

- Mac: Command + Option + I
- Windows: Control + Alt + I
  
```{r, echo=FALSE, out.width = '75%', fig.align= 'center'}
# include_graphics(path.expand("~/share/rstudioserverNewChunck.png"))
```

In order to run a chunk of code:

- Press the small teal arrow in the top right corner of the chunk
- Press Command + Option + C
- Press Control + Alt + C

```{r, echo=FALSE,  out.width = '75%', fig.align= 'center'}
include_graphics(path.expand("~/share/rstudioserverRunChunck.png"))
```

## Loading the data

The data is already saved to the server, using a different format than you have seen in the past. This time the data is saved as an .Rda file, or a "R data file". This format allows factors to be saved with orderings preloaded, among other 

```{r, echo = F, results = 'hide', message=F, warning = F}
load(path.expand("~/share/countyData.Rda"))
load(path.expand("~/share/cces.Rda"))
```



## Exploring the data

As before, the first thing we need to do is get an overview of the dataset we're working with. We will be examining two datasets in detail. The first is derived from the Cooperative Congressional Election Survey (CCES) run out of Harvard in collaboration with 30+ universities across the country. You can find more information at https://cces.gov.harvard.edu/. The second is a county level dataset on voting, demographics, and deaths of despair in 2016. Codebooks for both datasets are in the folder for this assignment.  Both are being used to  highlight different types of data. The county level dataset, due in part to the lack of need for anonymity for the respondents, shows more fine grained data than the individual level dataset. 

The first step in any data analysis project is to understand the data, the population the data reflects, and the size of the dataset. In this case, we have two datasets. The CCES dataset reflects self reported voting behavior, demographics, and opinions of a representative sample of all people in the United States (and a representative sample from each state). It has 64,600 respondents. The county level dataset, on the other hand, reflects voting, demographic, and deaths of despair for all counties in the United States.

### Exercise 1: 1 pt
How many counties are in the county dataset? How many respondents are in the CCES dataset?

*Answer* 
  There are 3,142 counties in the county dataset and 64,600 respondents in the CCES dataset.

\textcolor{red}{Points for Exercise 1: /1} 


# Understanding histograms and bar charts (but not box and whisker plots)

## Histograms, density plots, and summary statistics

Histograms and bar charts are two common methods to understand data. Both reflect different kinds of numerical summaries of the data, and both reflect important characteristics of the population reflected by the dataset (counties or US residents in the case of the data examined here).

```{r echo = F, warning= F, message = F, out.width = '45%'}
countyData %>% ggplot(aes(x= anyCollege)) +
  geom_histogram()+     
  labs(title = "Histogram:\n% of county with at least some college classes",
       x = "% of county with at least some college classes",
       caption = "Data: 2010-2020 County level presidential, demographics, and deaths of despair")+
  theme_bw()

countyData %>% ggplot(aes(x= anyCollege)) +
  geom_density(fill = 'grey')+     
  labs(title = "Density:\n% of county with at least some college classes",
       x = "% of county with at least some college classes",
       caption = "Data: 2010-2020 County level presidential, demographics, and deaths of despair")+
  theme_bw()
```

This is reflected by summary statistics regarding the minimum, median, mean, and maximum values.

```{r echo = F, warning= F, message = F}
countyData %>% 
  summarise(  min_college = min(anyCollege, na.rm=T),
              median_college = median(anyCollege, na.rm=T),
              mean_college = round(mean(anyCollege, na.rm=TRUE), 2),  
              max_college = max(anyCollege, na.rm=T),
              numberOfCounties=length(na.omit(anyCollege)))
```


We can see that the distribution is roughly unimodal and is not seriously skewed. On average, around 51% of a county's adult residents have attended at least some college. No county has fewer that 20% of the adult residents with college experience. No county has more than 91.5% of its adult residents with college experience.

### Exercise 2: 2 pts
 Pick one *continuous* variable that is interesting to you & has not yet been plotted. Find out their distribution in the dataset using both a histogram or density plot and by creating the summary statistics.  This variable will almost certainly originate in the county level data.
**you can find variables, and figure out what type of variable is which by looking at our data in the Environment pane - click the blue arrow and scroll down until you find one you want; it should be numeric (int or num) and have at least 20 possible values to qualify as reasonably continuous.** 

*Answer 2 (Create an R chunk below by pressing Ctrl+Alt+I or Cmd + Option + I and insert the appropriate code. We recommend copying and pasting code from above and modifying it to suite your needs.)*

```{r, eval = TRUE}
countyData %>% ggplot(aes(x= prcntPopChg)) +
  geom_histogram(binwidth = 10)+     
  labs(title = "Histogram:\n% population change among counties during 2016",
       x = "% change in county population during 2016",
       y = "number of counties",
       caption = "Data: 2010-2020 County level presidential, demographics, and deaths of despair")+
  theme_bw() +
  scale_x_continuous(breaks=seq(-1000, 2000,250))
```

\textcolor{red}{Points for Exercise 2: /2} 



### Exercise 3: 2 pts
What does the distribution of data show you?

*Answer 3 (write your answer in a few sentences below.)*

This distribution shows the vast majority of counties experienced between -250% and 250% population change during 2016. Furthermore, the distribution of counties' population change seems to center on 0% change. 

\textcolor{red}{Points for Exercise 3: /2} 


## Histograms, density plots, and summary statistics for discrete data

Discrete numeric data is sufficiently different from continuous numeric data that we will go through how to examine such data using histograms and density plots. However, note that many kinds of discrete data may be more usefully examined using a bar plot, which will be described later. 

Note that for all of the CCES data, the filter will be applied to focus on white voters. This is due to heterogeneous effects; that is, white voters behave differently than non-voters or non-white voters. For clarity, this will focus on white voters. 

```{r echo = F, warning= F, message = F, out.width = '45%'}
cces %>% filter(isWhite == 1 & voted_2016_num == 1) %>% 
  drop_na(vote16_trump) %>%
ggplot(aes(x=vote16_trump_num))+
  geom_histogram()+ 
  labs(title = "Histogram:\nIndividual level 2016 vote choice",
       x = "Vote Choice 2016\n(0 is voted but not for Trump, 1 is voted for Trump)",
       caption = "Data: 2016 CCES") + 
  theme_bw()

cces %>% filter(isWhite == 1 & voted_2016_num == 1) %>% 
  ggplot(aes(x= educ_approxYears)) +
  geom_histogram()+     
  labs(title = "Histogram:\nIndividual level educational attainment",
       x = "approximate years of education",
       caption = "Data: 2016 CCES") + 
  theme_bw()
```

This is reflected by summary statistics regarding the minimum, median, mean, and maximum values.


```{r echo = F, warning= F, message = F}
cces %>% filter(isWhite == 1 & voted_2016_num == 1) %>% 
 summarise(  min_voteTrump = min(vote16_trump_num, na.rm=T),
              median_voteTrump = median(vote16_trump_num, na.rm=T),
              mean_voteTrump = round(mean(vote16_trump_num, na.rm=TRUE), 2),  
              max_voteTrump = max(vote16_trump_num, na.rm=T),
              numberOfRespondents=length(na.omit(vote16_trump_num)))

cces %>% filter(isWhite == 1 & voted_2016_num == 1) %>% 
  summarise(  min_edu = min(educ_approxYears, na.rm=T),
              median_edu = median(educ_approxYears, na.rm=T),
              mean_edu = round(mean(educ_approxYears, na.rm=TRUE), 2),  
              max_edu = max(educ_approxYears, na.rm=T),
              numberOfRespondents=length(na.omit(educ_approxYears)))
```

We can see that on average, 48% of the 35,679 white voter respondents in the CCES data voted for Donald Trump. The minimum and maximum for the voteTrump variable are 0 (not Trump) and 1 (vote Trump), which is not surprising, since obviously at many respondents voted for Trump and many did not. 

In this case, education is an odd variable; the numbers are somewhat arbitrary. 10 represents "did not complete high school", or less than 12 years of schooling. 14 represents "2 year degree", which is 14 years of education for most folk. Yet we can still make some reasonable inferences from the summary statistics. Namely, on average, most respondents had at least some college experience. But you can see from the histogram that 14 approximate years of education is not the modal category, but simply the average (on both the median and mean scores). The distribution is bimodal, peaking at 12/13 (high school or some college experience) and 16 (completed college). 


### Exercise 4: 2 pts
 Pick one *numeric discrete* variable that is interesting to you & has not yet been plotted (looking at nonwhite or nonvoters for education or anythign else is fair game). Find out the distribution in the dataset using both a histogram or density plot and by creating the summary statistics. This may come from the county level data or from the individual level data.
**you can find variables, and figure out what type of variable is which by looking at our data in the Environment pane - click the blue arrow and scroll down until you find one you want** 

*Answer 4 ( create & run the code below.)*

```{r, eval = TRUE}
  cces %>% summarise(min_econ = min(personal_econ_worse_num, na.rm=T),
              median_econ = median(personal_econ_worse_num, na.rm=T),
              mean_econ = round(mean(personal_econ_worse_num, na.rm=TRUE), 2),  
              max_econ = max(personal_econ_worse_num, na.rm=T),
              numberOfRespondents=length(na.omit(personal_econ_worse_num)))


cces %>% ggplot(aes(x= personal_econ_worse_num)) +
  geom_histogram(binwidth = 0.05)+     
  labs(title = "Histogram: perception of changes in personal economic situations",
       x = "perception of change in personal economic situation",
       y = "number of respondents",
       caption = "Data: 2010-2020 County level presidential, demographics,
                  and deaths of despair")+
  theme_bw() +
  scale_x_continuous(labels = c("0" = "Increased a lot",
                                "0.25" = "Increased somewhat",
                                "0.5" = "Stayed the same", 
                                "0.75" = "Decreased somewhat",
                                "1" = "Decreased a lot"))
```


\textcolor{red}{Points for Exercise 4: /2} 

### Exercise 5: 2 pts
What does the distribution of data show you?

*Answer 5 (write your answer in a few sentences below.)*

This distribution of data shows that "stayed the same" was the most-often chosen response of the 5 options given to respondents to indicate their perception of their economic situation over the past four years. Importantly, however, substantially more respondents indicated their economic stituation improved somewhat or "a lot" rather than deteriorated somewhat or "a lot." 

\textcolor{red}{Points for Exercise 5: /2} 


## Bar plots and tabular statistics for discrete data

Discrete numeric data can also be productively summarized using bar plots. Unlike histograms, which effectively communicate mean/median/modes, bar plots effectively communicate counts and/or percentages.

**Note: A variety of commands to summarize the data are applied below. You do not need to understand all aspects right now. You'll copy and paste some of these commands and alter them to create your own results.**

```{r echo = F, warning= F, message = F}
#put the variable "education" into a sensible order: least education to most.
cces$educ <- factor(cces$educ, 
                           levels = c("No HS","High school graduate", 
                                      "Some college","2-year",
                                      "4-year","Post-grad"))

#create table of proportions, named edu_proportions. 
edu_proportions <- cces %>% filter(isWhite == 1 & voted_2016_num == 1) %>% 
  count( educ, name = "number_of_people") %>%   
  mutate(percentage = round(100*prop.table(number_of_people), 2))

#print the table of proportions
edu_proportions
```

```{r echo = F, warning= F, message = F, out.width = '40%'}
ggplot(data = edu_proportions, aes(x= educ, y = number_of_people, fill = educ))+
  geom_bar(stat = 'identity', color='black') + 
  scale_fill_brewer(palette='PuBu')+   #scale_fill is used when the 'fill' option is used to create colors
  labs(title = "Bar chart:\nCounts of respondents in each category",
       x = "Education",
       y = 'count',
       caption = "Data: CCES 2016") + theme_bw() + 
  theme(axis.text.x = element_text(angle=12, hjust = 1), legend.position="none")
```

Here, you see we've created a bar plot using *categorical/factor* version of the education variable. The histogram was created using the *numeric* version. Both show the same underlying pattern, but the bar plot emphasizes counts. 

In this case, the distribution is somewhat easier to describe using the categorical education variable and the corresponding bar plot. Namely, very few white voters did not complete high school. Most of the respondents were in one of three categories: high school graduate (23.58%), some college (23.71%), or a 4 year college degree (24.11%).

The choice of which graphic or summary to use depends on what aspect of the data you want to communicate and how easy it is to express the variable as categorical or numeric.


```{r echo = F, warning= F, message = F}
#put the variable "vote16_trump" into a defined order.
cces$vote16_trump <- factor(cces$vote16_trump, 
                           levels = c("Not Trump","Trump"))

#create table of proportions, named vote_proportions 
vote_proportions <- cces %>% 
  filter(isWhite == 1 & voted_2016_num == 1) %>% 
  count( vote16_trump, name = "number_of_people") %>%   
  mutate(percentage = round(100*prop.table(number_of_people), 2))

#print the table of proportions
vote_proportions
```

```{r echo = F, warning= F, message = F, out.width = '45%'}
ggplot(data = vote_proportions, aes(x= vote16_trump, y = number_of_people, fill = vote16_trump))+
  geom_bar(stat = 'identity', color= 'black') + 
  scale_fill_manual(values = c('blue','red'))+
  labs(title = "Bar chart:\nCounts of respondents in each category",
       x = "2016 vote choice",
       y = 'count',
       caption = "Data: CCES 2016") + theme_bw() + 
  theme(legend.position="none")
```

### Exercise 6: 3 pts
Which graphic did you prefer for showing the distribution of education: the histogram or the bar chart? Why?

*Answer 6 (write your answer in a sentence or two below)*

I preferred the bar chart because its x-axis labels are more meaningful to me.

\textcolor{red}{Points for Exercise 6: /3} 

 

### Exercise 7: 2 pts
Using the same *numeric discrete* variable that is interesting to you, and find out their distribution in the dataset using both a bar plot and by creating the counts/percentages statistics. This may come from the county level data or from the individual level data.
**you can find variables, and figure out what type of variable is which by looking at our data in the Environment pane - click the blue arrow and scroll down until you find one you want** 

*Answer 7 (Create the code below. Make sure your R chunk is either not named or named differently from any other R chunk)*

```{r, eval=TRUE}
perc_econ_proportions <- cces %>% 
  count(personal_econ_worse, name = "number_of_people") %>%   
  mutate(percentage = round(100*prop.table(number_of_people), 2))

perc_econ_proportions$personal_econ_worse <- factor(perc_econ_proportions$personal_econ_worse,
                                                    levels = c("decreased a lot",
"decreased somewhat", "stayed the same", "income increased somewhat", "income increased a lot"))

perc_econ_proportions

perc_econ_proportions2 <- perc_econ_proportions %>% filter(!is.na(personal_econ_worse))

ggplot(data = perc_econ_proportions2, aes(x= personal_econ_worse, y = percentage, fill = personal_econ_worse))+
  geom_bar(stat = 'identity', color='black') + 
  scale_fill_brewer(palette='PuBu')+   #scale_fill is used when the 'fill' option is used to create colors
  labs(title = "Bar chart:\nPercentage of respondents in each category",
       x = "Perceived Change in Personal Economic Situation",
       y = 'Percentage of Respondents',
       caption = "Data: CCES 2016") + theme_bw() + 
  theme(axis.text.x = element_text(angle=12, hjust = 1), legend.position="none")

```

\textcolor{red}{Points for Exercise 7: /2} 


### Exercise 8: 2 pts
Which graphic did you prefer for showing the distribution of your variable: the histogram or the bar chart? Why?

*Answer 8 (write your answer in a sentence or two below)*

I prefer the bar chart because I did not have to recode the numeric values corresponding to respondents' responses into meaningful labels. Also, ggplot naturally intuited its scale better.

\textcolor{red}{Points for Exercise 8: /2} 


### Exercise 9: 1 pts

How many people are in the least-common category of the variable you looked at?
*Answer below*

4470 people indicated that their income had increased "a lot."

\textcolor{red}{Points for Exercise 9: /1} 

### Exercise 10: 2 pts
What else do you notice about the distribution of these variables?
*Answer below*

As noted above, distribution of responses to this item center on “stayed the same” but "income increased somewhat" was more prevalent than "decreased somewhat." 

\textcolor{red}{Points for Exercise 10: /2} 


# Bivariate Relationships - between two categorical variables

OK, here is where we start  to be able to answer more interesting questions. We will start with thinking of bivariate relationships with categorical data; the next assignment will start looking at relationships between continuous variables using scatterplots and faceted histograms/density plots. 

There are many ways to explore the relationship between two categorical/discrete variables, as you will see below. We'll start with just looking at counts within category using a faceted bar chart. I've faceted it in two different directions and added a color coding that will be used throughout the remainder of this assignment (and in the poster of visuals). These two images are showing the same exact information, but the buckets are rotated with different color coding.

```{r echo = F, warning= F, message = F, out.width = '45%'}
countyData %>%
  drop_na(majorityTrump) %>%
  ggplot(aes(x=college_2cat, fill = majorityTrump)) + 
  geom_bar(color = 'black')+facet_grid(reorder(majorityTrump, desc(majorityTrump))~.)+
    scale_fill_manual(values =c("blue","red")) +  
  theme_bw()+
  labs(title = "Vertically faceted bar chart: \nCounts of counties by 2016 vote and education",
       x  = "Education", 
       fill = "2016 Vote",
       caption = "Data: 2010-2020 County level presidential,\ndemographics, and deaths of despair")

countyData %>%
  drop_na(college_2cat) %>%
  ggplot(aes(x=majorityTrump, fill = college_2cat)) + geom_bar(color = 'black')+
  facet_grid(college_2cat~.)+
      scale_fill_manual(values =c("black","skyblue")) +  
  theme_bw()+
  labs(title = "Vertically faceted bar chart: \nCounts of counties by education and 2016 vote",
       x  = "2016 Vote", 
       fill = "Education",
       caption = "Data: 2010-2020 county level presidential,\ndemographics, and deaths of despair")
```
```{r summary-stats-both-categorical-county, echo = F, warning= F, message = F}
countyData %>% 
  drop_na(majorityTrump) %>%
  group_by(college_2cat) %>%
  count(majorityTrump, college_2cat) %>%           
  rename(num_counties_by_eduCategory = n)
```


## Education and vote, bucketed by education first

The next thing you have to choose is your reference category to create percentages. For example, if looking at education and vote, you first have to choose whether you want to examine proportions voting within each education bucket, or proportions of education within each voting bucket. Your choice will depend on the pattern you want to present. Some of you may recognize this as row/column percentages, but that's based on a different presentation of results than we'll be using in this assignment.


```{r echo = F, warning= F, message = F}
trumpCollege_proportionsByEducation <- countyData %>% 
  drop_na(majorityTrump) %>%
  group_by(college_2cat) %>%
  count(majorityTrump, college_2cat) %>%           
  mutate(prcnt_by_collegeCategory = 100*prop.table(n))  %>%
  rename(num_counties_by_eduCategory = n)

trumpCollege_proportionsByEducation  
        #note: this table can also be produced with the command 
        # table(countyData$majorityTrump, countyData$college_2cat)
```

We can look at these numbers using a bar chart (in this case a dodged bar chart, both by percentage or count). If you look at the poster of all possible visuals, you'll see that you could also create a scatter plot or a faceted histogram or a dodged bar chart, among many other possibilities.

```{r echo = F, warning= F, message = F, out.width = '45%'}
ggplot(data = trumpCollege_proportionsByEducation, 
       aes(x = college_2cat, y = num_counties_by_eduCategory, fill = majorityTrump)) +
  geom_bar(stat = 'identity', position = 'dodge', color = 'black')+
  scale_fill_manual(values =c("blue","red")) +  
  theme_bw()+
  labs( title = 'Dodged bar chart: Count of counties\' 2016 vote by education',
       x  = "Education", 
       y = "Count",
       fill = "2016 Vote",
       caption = "Data: 2010-2020 county level presidential, demographics, and deaths of despair")+
  theme(legend.position="bottom")

ggplot(data = trumpCollege_proportionsByEducation, 
       aes(x = college_2cat, y = prcnt_by_collegeCategory, fill = majorityTrump)) +
  geom_bar(stat = 'identity', position = 'dodge', color = 'black')+
  scale_fill_manual(values =c("blue","red")) +  
  theme_bw()+
  labs( title = 'Dodged bar chart: % counties\' 2016 vote by education',
       x  = "Education", 
       y = "Percent",
       fill = "2016 Vote",
       caption = "Data: 2010-2020 county level presidential, demographics, and deaths of despair")+
  theme(legend.position="bottom")
```


```{r echo = F, warning= F, message = F, out.width = '45%'}
ggplot(data = trumpCollege_proportionsByEducation, 
       aes(x = college_2cat, y = prcnt_by_collegeCategory, fill = majorityTrump)) +
  geom_bar(stat = 'identity', position = 'stack', color = 'black')+
  scale_fill_manual(values =c("blue","red")) +  
  theme_bw()+
  labs( title = 'Stacked bar chart: % counties\' 2016 vote by education',
       x  = "Education", 
       y = "Percent",
       fill = "2016 Vote",
       caption = "Data: 2010-2020 county level presidential, demographics, and deaths of despair")+
  theme(legend.position="bottom")
```

## Education and vote, bucketed by vote

The other way to bucket this data is to bucket it by vote instead of by education. This will highlight different patterns in the data. 

```{r echo = F, warning= F, message = F}
trumpCollege_proportionsByTrumpVote <- countyData %>% 
  drop_na(majorityTrump) %>%
  group_by(majorityTrump) %>%
  count(majorityTrump, college_2cat) %>%  
  mutate(percent_by_voteCategory = 100*prop.table(n))  %>%
  rename(number_counties_by_voteCategory = n)

trumpCollege_proportionsByTrumpVote
```

```{r echo = F, warning= F, message = F, out.width = '45%'}
trumpCollege_proportionsByTrumpVote %>% 
  ggplot(aes(x = majorityTrump, y = number_counties_by_voteCategory, fill = college_2cat)) +
  geom_bar(stat = 'identity', position = 'dodge', color = 'black')+
  scale_fill_manual(values =c("black","skyblue")) +  
  theme_bw()+
  labs( title = 'Dodged bar chart:\nCount of counties education by 2016 vote',
       x  = "2016 Vote", 
       y = "Count",
       fill = "Education",
       caption = "Data: 2010-2020 county level presidential,\ndemographics, and deaths of despair")+
  theme(legend.position="bottom")

ggplot(data = trumpCollege_proportionsByTrumpVote, 
       aes(x = majorityTrump, y = percent_by_voteCategory, fill = college_2cat)) +
  geom_bar(stat = 'identity', position = 'dodge', color = 'black')+
  scale_fill_manual(values =c("black","skyblue")) +  
  theme_bw()+
  labs( title = 'Dodged bar chart:\n% of Counties\' Education by 2016 Vote',
       x  = "2016 Vote", 
       y = "Percent",
       fill = "Education",
       caption = "Data: 2010-2020 county level presidential,\ndemographics, and deaths of despair")+
  theme(legend.position="bottom")
```


```{r echo = F, warning= F, message = F, out.width = '45%'}
ggplot(data = trumpCollege_proportionsByTrumpVote, 
       aes(x = majorityTrump, y = percent_by_voteCategory, fill = college_2cat)) +
  geom_bar(stat = 'identity', position = 'stack', color = 'black')+
  scale_fill_manual(values =c("black","skyblue")) +  
  theme_bw()+
  labs( title = 'Stacked bar chart:\n% of Counties\' Education by 2016 Vote',
       x  = "2016 Vote", 
       y = "Percent",
       fill = "Education",
       caption = "Data: 2010-2020 county level presidential,\ndemographics, and deaths of despair")+
  theme(legend.position="bottom")
```


# Considering which category to bucket first

The decision over which bucketing system to use depends on the pattern in your data that you want to highlight. Carefully consider both bucketing systems for the county level data looking at education and voting. One bucketing system uses color for voting (red/blue) and education on the x-axis. The other uses color for education (sky blue/black) and voting on x-axis. Which one most effectively communicates an interesting story?

### Exercise 11: 2 pts
Which bucketing system was more effective for the county level data looking at education and voting? Why?

*Answer 11 (Answer in 3-6 sentences below)*

The bucketing system using color for education and voting on the x-axis more effectively communicates a relationship
between education levels and voting behaviors. Whereas it is difficult to compare the differences between the differences in heights of the bars on the chart using color for voting behavior, the difference in the heights of the high college attendance bars on the chart using color for education is clearly less than the differences in the heights of the low college attendance bars on the same chart. This allows the viewer to more easily observe that high college attendance counties were less favorable to Trump than low college attendance counties.

\textcolor{red}{Points for Exercise 11: /2} 

### Exercise 12: 2 pt
Which graphic (faceted, dodged bar chart of percentages, dodged bar chart of counts, stacked bar chart for either bucketing system) was the most effective? Why?

*Answer 12 (Answer in a few sentences below)*

The stacked bar chart was the most effective in communicating the greater preference for Trump among low college attendance counties. This is because it allows for side-by-side comparison of both the percentage of Clinton plurality counties in each education bucket and the percentage of Trump plurality counties in each education bucket. The rest of the graphics are impeded by the distance between these elements.

\textcolor{red}{Points for Exercise 12: /2} 



Now consider the following images, looking at the individual data, again for voting and education.

```{r echo = F, warning= F, message = F}
trumpCollege_proportionsByEducation <- cces %>% 
  filter(isWhite == 1 & voted_2016_num == 1) %>%  
  drop_na(vote16_trump) %>%
  group_by(anyCollege) %>%
  count(vote16_trump, anyCollege) %>%           
  mutate(percent_by_collegeCategory = round(100*prop.table(n),2))  %>%
  rename(number_voters_by_collegeCategory = n)

trumpCollege_proportionsByEducation

trumpCollege_proportionsByTrumpVote <- cces %>% 
  filter(isWhite == 1 & voted_2016_num == 1) %>%  
  drop_na(vote16_trump) %>%
  group_by(vote16_trump) %>%
  count(anyCollege, vote16_trump) %>%  
  mutate(percent_by_voteCategory = 100*prop.table(n))  %>%
  rename(number_voters_by_voteCategory = n)


trumpCollege_proportionsByTrumpVote
```


```{r echo = F, warning= F, message = F, out.width = '45%'}
ggplot(data = trumpCollege_proportionsByTrumpVote, aes(x = vote16_trump, y = number_voters_by_voteCategory, fill = anyCollege)) +
  geom_bar(stat = 'identity', position = 'dodge')+
  scale_fill_manual(values =c("black","skyblue")) +  
  theme_bw()+
  labs( title = 'Dodged bar chart: Count of respondents\'\neducational attainment by 2016 vote',
       x  = "Vote Choice", 
       y = "Count",
       fill = "Education",
       caption = 'Data: 2016 CCES')+ 
  theme(legend.position="bottom")

ggplot(data = trumpCollege_proportionsByEducation, aes(x = anyCollege, y = number_voters_by_collegeCategory, fill = vote16_trump)) +
  geom_bar(stat = 'identity', position = 'dodge')+
  scale_fill_manual(values =c("blue","red")) +  
  theme_bw()+
  labs( title = 'Dodged bar chart: Count of respondents\'\n2016 vote by educational attainment',
       x  = "Education", 
       y = "Count",
       fill = "2016 vote",
       caption = 'Data: 2016 CCES')+ 
  theme(legend.position="bottom")

```


### Exercise 13: 2 pts
Which bucketing system was more effective for the individual level data looking at education and voting? Why?

*Answer 13 (Answer in a few sentences or a paragraph below)*

Similar to the preference I indicated in Exercise 11, I believe the bucketing system using the x-axis for vote choice and color for educational attainment is the more effective graphic of the two above graphics. The bucketing system using the x-axis for vote choice highlights greater differences between adjacent bars (in this case, within vote choice). This better communicates to the viewer that non-Trump voters were more likely to have attained at least some college education relative to Trump voters. 

\textcolor{red}{Points for Exercise 13: /2} 


You may have a different answer than your classmates to Exercise 11 and 13. However, many of you will choose the opposite bucketing system for the individual data vs the county data. That is, you may have chosen education for the colors (sky blue/black) and voting for the x-axis for the county data, and voting for the colors (red/blue) and education for the x-axis for the individual data, or vice versa. 

The moral of the story is that there is often no set proscriptions on how to visualize your variables. Your choice of which system to use will depend on which story you want to emphasize. 